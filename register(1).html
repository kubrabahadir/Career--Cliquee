<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Login/Register</title>
  <!-- Cool Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Bowlby+One+SC&display=swap" rel="stylesheet" />
  <!-- Our stylesheet -->
  <link rel="stylesheet" type="text/css" href="styles/register.css" />
</head>

<body>
  <div id="content_container" class="container">
    <img src="images/logo.png" alt="Logo" />
    <h2>Career Cliquee</h2>
    <form id="register-form">
      <div class="form-field">
        <label for="firstName">First Name</label>
        <input type="text" id="firstName" name="firstName" required />
      </div>
      <div class="form-field">
        <label for="lastName">Last Name</label>
        <input type="text" id="lastName" name="lastName" required />
      </div>
      <div class="form-field">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required />
      </div>
      <div class="form-field">
        <label for="password">Password</label>
        <input type="password" id="password" name="password" required />
      </div>
      <div class="form-field">
        <label for="confirm-password">Confirm Password</label>
        <input type="password" id="confirm-password" name="confirm-password" required />
      </div>
      <div class="form-field">
        <label for="userType">User Type</label>
        <select id="userType" name="userType" required>
          <option value="" disabled selected>Select User Type</option>
          <option value="student-working">Student - Working</option>
          <option value="student-not-working">Student - Not Working</option>
          <option value="graduate-working">Graduate - Working</option>
          <option value="graduate-not-working">Graduate - Not Working</option>
        </select>
      </div>
      <input type="button" value="Submit" class="sub" id="submit" />
    </form>
    <p>Already have an account? <a href="login.html">Login</a></p>
    <button id="company-register">Registration for Companies</button>
  </div>

  <!-- Firebase JavaScript SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-database.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDbRHsscoIn_MHz3q9dS3St-MynPWbw6ls",
      authDomain: "thesis-career-cliquee.firebaseapp.com",
      projectId: "thesis-career-cliquee",
      storageBucket: "thesis-career-cliquee.appspot.com",
      messagingSenderId: "605410191328",
      appId: "1:605410191328:web:c23aa6801ff94182e76d85"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref(); // Değişiklik yapıldı

    document.getElementById("submit").addEventListener('click', function (e) {
      e.preventDefault();
      const firstName = document.getElementById("firstName").value;
      const lastName = document.getElementById("lastName").value;
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const confirmPassword = document.getElementById("confirm-password").value;
      const userType = document.getElementById("userType").value;

      // Veritabanına eklemeden önce şifreleri kontrol edelim
      if (password !== confirmPassword) {
        alert("Passwords do not match.");
        return;
      }

      <!-- // Kullanıcı verilerini Firebase veritabanına ekle
      db.child('users/' + firstName).set({ // Değişiklik yapıldı
        firstName: firstName,
        lastName: lastName,
        email: email,
        password: password,
        'confirm-password': confirmPassword,
        userType: userType
      }).then(() => {
        alert("Registration successful!");
        // Kayıt işlemi başarılı olduğunda yapılacak diğer işlemler buraya eklenebilir
      }).catch((error) => {
        console.error("Error adding user: ", error);
        alert("An error occurred. Please try again later.");
      }); -->
      
      // first need to auth the user from firebase
      const onSingin = (email, password) => {
        app.auth().signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // then after the user is created, add the user to the database
            const user = userCredential.user;
            db.collection("users").doc(user.uid).set({
              owner_uid: users.uid,
              firstName: firstName,
              lastName: lastName,
              email: email,
              password: password,
              confirm_password: confirmPassword,
              userType: userType
            })
          })
          .catch((error) => {
            var errorCode = error.code;
            var errorMessage = error.message;
            console.error("Error adding user: ", errorCode);
            alert(errorMessage);
          });
      }
    });
  </script>
  <!-- Our script must be loaded after Firebase references -->

</body>

</html>